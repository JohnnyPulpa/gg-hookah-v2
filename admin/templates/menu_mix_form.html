{% extends "base.html" %}
{% block title %}GG HOOKAH ‚Äî {{ 'Edit Mix' if is_edit else 'New Mix' }}{% endblock %}
{% block sidebar_active %}menu{% endblock %}

{% block extra_styles %}
<style>
    .main { max-width: 700px; }

    .form-block { background: #16213e; border-radius: 12px; padding: 24px; border: 1px solid #0f3460; }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; font-size: 13px; font-weight: 600; color: #8892a4; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group input[type="url"],
    .form-group textarea {
        width: 100%; padding: 10px 14px; border-radius: 8px; border: 1px solid #0f3460;
        background: #1a1a2e; color: #e0e0e0; font-size: 14px; font-family: inherit;
    }
    .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #F28C18; }
    .form-group textarea { resize: vertical; min-height: 80px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .form-row-4 { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 12px; }

    .range-group { display: flex; align-items: center; gap: 10px; }
    .range-group input[type="range"] { flex: 1; accent-color: #F28C18; }
    .range-value { min-width: 24px; text-align: center; font-weight: 700; color: #F28C18; }

    .checkbox-group { display: flex; align-items: center; gap: 10px; }
    .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; accent-color: #F28C18; }

    .actions-bar { display: flex; gap: 10px; margin-top: 20px; }

    .img-preview { width: 80px; height: 80px; border-radius: 10px; object-fit: cover; background: #0f3460; margin-top: 6px; }
</style>
{% endblock %}

{% block content %}
    <a href="{{ url_for('menu.mixes_list') }}" class="back-link">‚Üê Back to Mixes</a>
    <h2>{{ '‚úèÔ∏è Edit Mix' if is_edit else '‚ûï New Mix' }}</h2>

    <form method="POST" class="form-block">
        <div class="form-group">
            <label>Name *</label>
            <input type="text" name="name" value="{{ mix.name if mix else '' }}" required placeholder="e.g. Lemon Mint">
        </div>

        <div class="form-group">
            <label>Flavors *</label>
            <input type="text" name="flavors" value="{{ mix.flavors if mix else '' }}" required placeholder="e.g. Lemon, Mint">
        </div>

        <div class="form-group">
            <label>Description</label>
            <textarea name="description" placeholder="Short description for catalog">{{ mix.description if mix and mix.description else '' }}</textarea>
        </div>

        <div class="form-group">
            <label>Details (tobacco brands + %)</label>
            <textarea name="details" placeholder="e.g. Tangiers Birquq 40%, Al Fakher Mint 60%">{{ mix.details if mix and mix.details else '' }}</textarea>
        </div>

        <div class="form-group">
            <label>Image URL *</label>
            <input type="url" name="image_url" value="{{ mix.image_url if mix else '' }}" required placeholder="https://...">
            {% if mix and mix.image_url %}
                <img src="{{ mix.image_url }}" class="img-preview" alt="Preview">
            {% endif %}
        </div>

        <!-- Characteristics 1-5 -->
        <div class="form-row-4">
            <div class="form-group">
                <label>Strength</label>
                <div class="range-group">
                    <input type="range" name="strength" min="1" max="5" value="{{ mix.strength if mix else 3 }}" oninput="this.nextElementSibling.textContent=this.value">
                    <span class="range-value">{{ mix.strength if mix else 3 }}</span>
                </div>
            </div>
            <div class="form-group">
                <label>Coolness</label>
                <div class="range-group">
                    <input type="range" name="coolness" min="1" max="5" value="{{ mix.coolness if mix else 3 }}" oninput="this.nextElementSibling.textContent=this.value">
                    <span class="range-value">{{ mix.coolness if mix else 3 }}</span>
                </div>
            </div>
            <div class="form-group">
                <label>Sweetness</label>
                <div class="range-group">
                    <input type="range" name="sweetness" min="1" max="5" value="{{ mix.sweetness if mix else 3 }}" oninput="this.nextElementSibling.textContent=this.value">
                    <span class="range-value">{{ mix.sweetness if mix else 3 }}</span>
                </div>
            </div>
            <div class="form-group">
                <label>Smokiness</label>
                <div class="range-group">
                    <input type="range" name="smokiness" min="1" max="5" value="{{ mix.smokiness if mix else 3 }}" oninput="this.nextElementSibling.textContent=this.value">
                    <span class="range-value">{{ mix.smokiness if mix else 3 }}</span>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Sort Order</label>
                <input type="number" name="sort_order" value="{{ mix.sort_order if mix else 0 }}" min="0">
            </div>
            <div class="form-group" style="display: flex; flex-direction: column; justify-content: flex-end;">
                <div class="checkbox-group">
                    <input type="checkbox" name="is_active" id="is_active" {{ 'checked' if (not mix or mix.is_active) else '' }}>
                    <label for="is_active" style="margin: 0; text-transform: none;">Active</label>
                </div>
                <div class="checkbox-group" style="margin-top: 8px;">
                    <input type="checkbox" name="is_featured" id="is_featured" {{ 'checked' if mix and mix.is_featured else '' }}>
                    <label for="is_featured" style="margin: 0; text-transform: none;">‚≠ê Mix of the Week</label>
                </div>
            </div>
        </div>

        <div class="actions-bar">
            <button type="submit" class="btn btn-orange">{{ 'üíæ Save Changes' if is_edit else '‚ûï Create Mix' }}</button>
            <a href="{{ url_for('menu.mixes_list') }}" class="btn btn-gray">Cancel</a>
        </div>
    </form>
{% endblock %}
